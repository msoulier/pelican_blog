<!DOCTYPE html>
<html lang="en">
<head>
        <title>But I Digress</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="./theme/css/main.css" type="text/css" />
        
        
        <link href="http://feeds.feedburner.com/ButIDigress" type="application/rss+xml" rel="alternate" title="But I Digress RSS Feed" />
        

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="./css/ie.css"/>
                <script src="./js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="./css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">

<a href="http://github.com/msoulier">

<img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />

</a>

        <header id="banner" class="body">
                <h1><a href=".">But I Digress </a></h1>
                <h2>Random neuron firings, digitized heedless of the
                repurcussions.</h2>
                <nav><ul>
                
                
                
                    <li><a href="./pages/resume.html">Resum√©</a></li>
                
                
                
                    <li ><a href="./category/development.html">Development</a></li>
                
                    <li ><a href="./category/personal.html">Personal</a></li>
                
                    <li ><a href="./category/technology.html">Technology</a></li>
                
                </ul></nav>
        </header><!-- /#banner -->
                

            

        
        
            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="./suspend-on-lid-close-debian-squeeze.html">Suspend on lid close in Debian Squeeze</a></h1> 
                    <footer class="post-info">
        <abbr class="published" title="2012-11-20T22:10:00">
                Tue 20 November 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href="./author/michael-p-soulier.html">Michael P. Soulier</a>
        </address>
        
<p>In <a href="./category/technology.html">Technology</a>. </p>
<p>tags: <a href="./tag/linux.html">Linux</a><a href="./tag/open-source.html">Open Source</a><a href="./tag/python.html">Python</a></p>


</footer><!-- /.post-info --><p>I recently decided that <a class="reference external" href="http://www.gnome.org">Gnome</a> is not the best desktop for my little <a class="reference external" href="http://www.asus.com/Eee/">EeePC</a>
netbook with a little 10.5&quot; screen. So I'm playing around with a window
manager that mainly just maximizes everything. I've tried <a class="reference external" href="http://www.nongnu.org/ratpoison/">Ratpoison</a>, I've
tried <a class="reference external" href="https://code.google.com/p/wmii/">wmii</a>, and now I'm trying <a class="reference external" href="http://awesome.naquadah.org/">Awesome</a>.</p>
<p>I have a lot of customizations to do, but one thing that was missing was a way
to suspend the netbook when the laptop lid is closed. I could manually run
<tt class="docutils literal">acpitool <span class="pre">-s</span></tt> in a shell, or <tt class="docutils literal"><span class="pre">pm-suspend</span></tt>, but it's best handled by DBus, as
intended.</p>
<p>Now, a simple way to have DBus do the work is using <tt class="docutils literal"><span class="pre">dbus-send</span></tt>, like so:</p>
<pre class="literal-block">
dbus-send --print-reply \
          --system \
          --dest=org.freedesktop.UPower \
          /org/freedesktop/UPower \
          org.freedesktop.UPower.Suspend
</pre>
<p>The hard part is subscribing to the lid close event, so I'm not polling all
the time, exactly what DBus was written to prevent. I had a Python script for
this, but the API was changed in Squeeze to use the <a class="reference external" href="http://upower.freedesktop.org/">UPower</a> daemon and API.</p>
<p>I had to do some poking around to figure out how to update it, but I just got
it working, so I thought I'd share.</p>
<div class="highlight"><pre><span class="c">#!/usr/bin/python</span>

<span class="kn">import</span> <span class="nn">dbus</span><span class="o">,</span> <span class="nn">gobject</span><span class="o">,</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">dbus.mainloop.glib</span> <span class="kn">import</span> <span class="n">DBusGMainLoop</span>

<span class="n">pow_prop_iface</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">pow_iface</span> <span class="o">=</span> <span class="bp">None</span>

<span class="k">def</span> <span class="nf">handle_lidclose</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">closed</span> <span class="o">=</span> <span class="n">pow_prop_iface</span><span class="o">.</span><span class="n">Get</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span>
                                <span class="s">&#39;LidIsClosed&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">closed</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;lid is closed, suspending&quot;</span>
        <span class="n">pow_iface</span><span class="o">.</span><span class="n">Suspend</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;lid is open&quot;</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">pow_prop_iface</span><span class="p">,</span> <span class="n">pow_iface</span>

    <span class="n">DBusGMainLoop</span><span class="p">(</span><span class="n">set_as_default</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="n">bus</span> <span class="o">=</span> <span class="n">dbus</span><span class="o">.</span><span class="n">SystemBus</span><span class="p">()</span>

    <span class="n">power_proxy</span> <span class="o">=</span> <span class="n">bus</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="s">&#39;org.freedesktop.UPower&#39;</span><span class="p">,</span>
                                <span class="s">&#39;/org/freedesktop/UPower&#39;</span><span class="p">)</span>

    <span class="n">pow_prop_iface</span> <span class="o">=</span> <span class="n">dbus</span><span class="o">.</span><span class="n">Interface</span><span class="p">(</span><span class="n">power_proxy</span><span class="p">,</span>
                                    <span class="s">&#39;org.freedesktop.DBus.Properties&#39;</span><span class="p">)</span>
    <span class="n">pow_iface</span> <span class="o">=</span> <span class="n">dbus</span><span class="o">.</span><span class="n">Interface</span><span class="p">(</span><span class="n">power_proxy</span><span class="p">,</span>
                               <span class="s">&#39;org.freedesktop.UPower&#39;</span><span class="p">)</span>

    <span class="k">print</span> <span class="s">&quot;Registering a signal receiver for upower events...&quot;</span>

    <span class="n">bus</span><span class="o">.</span><span class="n">add_signal_receiver</span><span class="p">(</span><span class="n">handle_lidclose</span><span class="p">,</span>
                            <span class="n">dbus_interface</span><span class="o">=</span><span class="s">&quot;org.freedesktop.UPower&quot;</span><span class="p">,</span>
                            <span class="n">signal_name</span><span class="o">=</span><span class="s">&quot;Changed&quot;</span><span class="p">)</span>


    <span class="n">loop</span> <span class="o">=</span> <span class="n">gobject</span><span class="o">.</span><span class="n">MainLoop</span><span class="p">()</span>
    <span class="n">loop</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
<p>Now I just run it in the background from my <cite>.xsession</cite> script at X11 login,
and it's sitting there waiting for any change in UPower status. Works like a
charm.</p>
<p>There are <a href="./suspend-on-lid-close-debian-squeeze.html#disqus_thread">comments</a>.</p>
                </article>
                
            </aside><!-- /#featured -->
            
                <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">
            
        
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href="./apple-and-joysticks.html" rel="bookmark"
                           title="Permalink to Joysticks? We don't need no stinking joysticks...">Joysticks? We don't need no stinking joysticks...</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-11-19T13:00:00">
                Mon 19 November 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href="./author/michael-p-soulier.html">Michael P. Soulier</a>
        </address>
        
<p>In <a href="./category/technology.html">Technology</a>. </p>
<p>tags: <a href="./tag/os-x.html">OS X</a></p>


</footer><!-- /.post-info -->
                <p>So, after unpackaging my brand-spanking new Mac Mini, I grabbed a copy of the
<a class="reference external" href="http://www.x-plane.com">X-Plane</a> demo, dropped in an old usb joystick and fired it up. Oddly, X-Plane
itself asked me if I wanted to calibrate the joystick, which struck me as odd,
that hasn't happened in years, not ...</p>
                <a class="readmore" href="./apple-and-joysticks.html">read more</a>
                <p>There are <a href="./apple-and-joysticks.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href="./umm-done-unzipping-yet.html" rel="bookmark"
                           title="Permalink to Umm, done unzipping yet?">Umm, done unzipping yet?</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-11-17T14:00:00">
                Sat 17 November 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href="./author/michael-p-soulier.html">Michael P. Soulier</a>
        </address>
        
<p>In <a href="./category/technology.html">Technology</a>. </p>
<p>tags: <a href="./tag/os-x.html">OS X</a></p>


</footer><!-- /.post-info -->
                <p>So, the first thing I did after after wrapping my head around the cocoa
interface was to start installing software like a madman. I wanted Firefox,
VLC, Kobo, Gimp, Vim, etc, etc, etc. So, I had to learn how to install apps on
OS X.</p>
<p>Apps in OS X seem ...</p>
                <a class="readmore" href="./umm-done-unzipping-yet.html">read more</a>
                <p>There are <a href="./umm-done-unzipping-yet.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href="./fruit-on-my-screen.html" rel="bookmark"
                           title="Permalink to Ok, nobody panic, there's a fruit on my screen">Ok, nobody panic, there's a fruit on my screen</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-11-16T18:00:00">
                Fri 16 November 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href="./author/michael-p-soulier.html">Michael P. Soulier</a>
        </address>
        
<p>In <a href="./category/technology.html">Technology</a>. </p>
<p>tags: <a href="./tag/os-x.html">OS X</a></p>


</footer><!-- /.post-info -->
                <p>I've needed a new desktop for a while now. As I'm primarily a Unix user, I
typically buy a cheap PC and put <a class="reference external" href="http://www.linux.org">Linux</a> on it. This involves doing a bunch of
research into available hardware to make sure that everything is going to
work, like accelerated graphics ...</p>
                <a class="readmore" href="./fruit-on-my-screen.html">read more</a>
                <p>There are <a href="./fruit-on-my-screen.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href="./curling-and-life.html" rel="bookmark"
                           title="Permalink to What Curling has taught me about life">What Curling has taught me about life</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-11-09T10:00:00">
                Fri 09 November 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href="./author/michael-p-soulier.html">Michael P. Soulier</a>
        </address>
        
<p>In <a href="./category/personal.html">Personal</a>. </p>
<p>tags: <a href="./tag/curling.html">Curling</a><a href="./tag/hobbies.html">Hobbies</a></p>


</footer><!-- /.post-info -->
                <p>I've been curling for about 4 years now, and it's already taught me a lot
about life. I thought I'd share some of what it has taught me:</p>
<blockquote>
<ul class="simple">
<li>balance is very important</li>
<li>anything worthwhile requires hard work</li>
<li>you often can't brute force your way out of ...</li></ul></blockquote>
                <a class="readmore" href="./curling-and-life.html">read more</a>
                <p>There are <a href="./curling-and-life.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href="./i-sit-too-much.html" rel="bookmark"
                           title="Permalink to I sit too much">I sit too much</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-11-08T12:00:00">
                Thu 08 November 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href="./author/michael-p-soulier.html">Michael P. Soulier</a>
        </address>
        
<p>In <a href="./category/personal.html">Personal</a>. </p>
<p>tags: <a href="./tag/health.html">Health</a></p>


</footer><!-- /.post-info -->
                <p>Yeah, I really do. From my childhood I always prefered more intellectual
activities than active ones, reading, watching movies, tv. Growing up
asthmatic had something to do with that, but I overcame it later in life and
had no excuses anymore. Still, studies to do, computers to play with, digital ...</p>
                <a class="readmore" href="./i-sit-too-much.html">read more</a>
                <p>There are <a href="./i-sit-too-much.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href="./21st-century-c.html" rel="bookmark"
                           title="Permalink to 21st Century C">21st Century C</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-11-06T22:12:00">
                Tue 06 November 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href="./author/michael-p-soulier.html">Michael P. Soulier</a>
        </address>
        
<p>In <a href="./category/development.html">Development</a>. </p>
<p>tags: <a href="./tag/cc.html">C/C++</a><a href="./tag/books.html">Books</a></p>


</footer><!-- /.post-info -->
                <p>I saw a sale from <a class="reference external" href="http://oreilly.com/">O'Reilly Publishing</a> tonight on an new ebook for
<a class="reference external" href="http://shop.oreilly.com/product/0636920025108.do?code=WKCPRGM">21st Century C</a>. I have a good history with O'Reilly and C programming, so
it caught my attention.</p>
<p>When I was in University, <a class="reference external" href="http://shop.oreilly.com/product/9781565923065.do?code=WKCPRGM">Practical C Programming</a>
taught me much more than any of my professors ...</p>
                <a class="readmore" href="./21st-century-c.html">read more</a>
                <p>There are <a href="./21st-century-c.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href="./dusting-off-old-games.html" rel="bookmark"
                           title="Permalink to Dusting off old games">Dusting off old games</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-11-04T18:43:00">
                Sun 04 November 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href="./author/michael-p-soulier.html">Michael P. Soulier</a>
        </address>
        
<p>In <a href="./category/personal.html">Personal</a>. </p>
<p>tags: <a href="./tag/hobbies.html">Hobbies</a><a href="./tag/sfb.html">SFB</a></p>


</footer><!-- /.post-info -->
                <p>Back before I had any real responsibilities, I spent a lot of time playing
various games. I've probably played most of them. Roleplaying games, tabletop
battle simulations, although I stayed away from the card games like <a class="reference external" href="http://www.wizards.com/Magic/Summoner/">Magic</a>.
I'll rant about that some other time.</p>
<p>My two favorite games ...</p>
                <a class="readmore" href="./dusting-off-old-games.html">read more</a>
                <p>There are <a href="./dusting-off-old-games.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            

        
         
            
            <li><article class="hentry">    
                <header>
                    <h1><a href="./new-static-blog.html" rel="bookmark"
                           title="Permalink to New blog">New blog</a></h1>
                </header>
                
                <div class="entry-content">
                <footer class="post-info">
        <abbr class="published" title="2012-11-03T10:20:00">
                Sat 03 November 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href="./author/michael-p-soulier.html">Michael P. Soulier</a>
        </address>
        
<p>In <a href="./category/personal.html">Personal</a>. </p>
<p>tags: <a href="./tag/blogging.html">Blogging</a><a href="./tag/python.html">Python</a></p>


</footer><!-- /.post-info -->
                <p>So I decided to dump Wordpress and go to something that I have more control
over. I was thinking of building my own static blogging system, but I looked
around and found that there are a few already. Being a fan of <a class="reference external" href="http://www.python.org/">Python</a> I
decided to try out <a class="reference external" href="http://docs.getpelican.com/en/3.0/">Pelican</a>. It ...</p>
                <a class="readmore" href="./new-static-blog.html">read more</a>
                <p>There are <a href="./new-static-blog.html#disqus_thread">comments</a>.</p>
                </div><!-- /.entry-content -->
            </article></li>
        
        
            </ol><!-- /#posts-list -->
            
                
<p class="paginator">
    
    Page 1 / 1
    
</p>

            
            </section><!-- /#content -->
        
    


        <section id="extras" class="body">
        
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                        
                            <li><a href="http://docs.notmyidea.org/alexis/pelican/">Pelican</a></li>
                        
                            <li><a href="http://python.org">Python.org</a></li>
                        
                            <li><a href="http://jinja.pocoo.org">Jinja2</a></li>
                        
                            <li><a href="http://fit613.wordpress.com">Fit613</a></li>
                        
                            <li><a href="http://excess.org">Ian Ward</a></li>
                        
                            <li><a href="http://www.mahdiyusuf.com/">Mahdi Yusuf</a></li>
                        
                            <li><a href="http://mikegrouchy.com/">Mike Grouchy</a></li>
                        
                        </ul>
                </div><!-- /.blogroll -->
        
        
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            
                            
                                
                            <li><a href="http://feeds.feedburner.com/ButIDigress" type="application/rss+xml" rel="alternate">rss feed</a></li>
                                
                            

                        
                            <li><a href="http://twitter.com/msoulier">Twitter</a></li>
                        
                        </ul>
                </div><!-- /.social -->
        
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                <p>Email me at msoulier at digitaltorque dot ca</p>
                </address><!-- /#about -->

        </footer><!-- /#contentinfo -->




<script type="text/javascript">
    var disqus_shortname = 'butidigressca';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

</body>
</html>