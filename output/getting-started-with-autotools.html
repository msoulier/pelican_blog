<!DOCTYPE html>
<html lang="en">
<head>
        <title>Getting started with autotools</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="./theme/css/main.css" type="text/css" />
                        <link href="http://feeds.feedburner.com/ButIDigress" type="application/rss+xml" rel="alternate" title="But I Digress RSS Feed" />
        
        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="./css/ie.css"/>
                <script src="./js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="./css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">
<a href="http://github.com/msoulier">
<img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />
</a>
        <header id="banner" class="body">
                <h1><a href=".">But I Digress </a></h1>
                <h2>Random neuron firings, digitized heedless of the
                repurcussions.</h2>
                <nav><ul>
                                                                    <li><a href="./pages/michael-p-souliers-curriculum-vitae.html">Michael P. Soulier's Curriculum Vitae</a></li>
                                                                    <li ><a href="./category/customer-service.html">Customer Service</a></li>
                                    <li class="active"><a href="./category/development.html">Development</a></li>
                                    <li ><a href="./category/driving.html">Driving</a></li>
                                    <li ><a href="./category/personal.html">Personal</a></li>
                                    <li ><a href="./category/quotes.html">Quotes</a></li>
                                    <li ><a href="./category/technology.html">Technology</a></li>
                                </ul></nav>
        </header><!-- /#banner -->
        <section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="getting-started-with-autotools.html" rel="bookmark"
           title="Permalink to Getting started with autotools">Getting started with autotools</a></h1>
      <a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="msoulier">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
    </header>

    <div class="entry-content">
      <footer class="post-info">
        <abbr class="published" title="2012-12-16T08:30:00">
                Sun 16 December 2012
        </abbr>

                <address class="vcard author">
                By <a class="url fn" href="./author/michael-p-soulier.html">Michael P. Soulier</a>
        </address>
        <p>In <a href="./category/development.html">Development</a>. </p>
<p>tags: <a href="./tag/cc.html">C/C++</a><a href="./tag/foss.html">FOSS</a><a href="./tag/autotools.html">Autotools</a></p></footer><!-- /.post-info -->      <p>So, I'm still reading O'Rielly's <a class="reference external" href="http://www.but-i-digress.ca/21st-century-c.html">21st Century C</a>. I know, too many books on
the go and I read slowly, and not often enough. I'm going through the section
on <a class="reference external" href="http://www.gnu.org/software/autoconf/">GNU autotools</a>, which I've never been a heavy user of, albiet I'm a heavy
consumer of. I just don't spend much time distributing C/C++ across platforms.</p>
<p>I have a little C tool that I figured I'd try it on, a small replacement for
GNU tree that I wrote a while back, and since <tt class="docutils literal">tree</tt> isn't available on
OS X, it seemed a good excuse to port it. Previously I just had a Makefile
that I maintained, and it works fine, but it's a good excuse to learn how to
use autotools for the future. I do have some libraries, and they're harder to
port, which is where <a class="reference external" href="http://www.gnu.org/software/libtool/">libtool</a> comes in.</p>
<p>This <tt class="docutils literal">build</tt> script outlines the process of using autotools for the first
time. This script borrows very heavily from the book's author.</p>
<div class="highlight"><pre><span class="c">#!/bin/sh</span>

<span class="nb">echo</span> <span class="s2">&quot;Creating Makefile.am&quot;</span>
cat &gt; Makefile.am <span class="s">&lt;&lt;EOF</span>
<span class="s">bin_PROGRAMS=twig</span>
<span class="s">twig_SOURCES=twig.c</span>
<span class="s">EOF</span>

<span class="nb">echo</span> <span class="s2">&quot;Running autoscan...&quot;</span>
autoscan

<span class="nb">echo</span> <span class="s2">&quot;Creating configure.ac...&quot;</span>
sed -e <span class="s1">&#39;s/FULL-PACKAGE-NAME/twig/&#39;</span> <span class="se">\</span>
    -e <span class="s1">&#39;s/VERSION/1.0/&#39;</span>   <span class="se">\</span>
    -e <span class="s1">&#39;s|BUG-REPORT-ADDRESS|msoulier@digitaltorque.ca|&#39;</span> <span class="se">\</span>
    -e <span class="s1">&#39;10i\</span>
<span class="s1">    AM_INIT_AUTOMAKE&#39;</span> <span class="se">\</span>
        &lt; configure.scan &gt; configure.ac

<span class="nb">echo</span> <span class="s2">&quot;Creating additional files...&quot;</span>
touch NEWS README AUTHORS ChangeLog

<span class="nb">echo</span> <span class="s2">&quot;Running autoreconf...&quot;</span>
autoreconf -iv

<span class="nb">echo</span> <span class="s2">&quot;Running configure...&quot;</span>
./configure

<span class="nb">echo</span> <span class="s2">&quot;Running make distcheck to package sources...&quot;</span>
make distcheck
</pre></div>
<p>At this point, it's not ready to ship, as the <tt class="docutils literal">NEWS</tt>, <tt class="docutils literal">README</tt>,
<tt class="docutils literal">AUTHORS</tt> and <tt class="docutils literal">ChangeLog</tt> aren't populated yet. But it's close. The
<tt class="docutils literal">configure</tt> script works, and I could then build it on OS X using the
expected.</p>
<div class="highlight"><pre>./configure --prefix<span class="o">=</span>/usr/local
make
make install
</pre></div>
<p>My next project to package is a shared library for work, so that will be more
interesting. Still, if you're looking to use autotools for the first time for
something simple, this should take the mystery out of kick-starting it. Sure,
there's some magic like the <tt class="docutils literal">AM_INIT_AUTOMAKE</tt> macro, and I've a ton to
learn yet, but this worked on the first try, and the resulting tarball is good
to push to <a class="reference external" href="http://sourceforge.net/">SourceForge</a> or elsewhere if you want to.</p>
<p>As I pick up more, I'll try to share it. I don't find autotools intuitive at
all, but with some simple recipes I think I'll survive.</p>

    </div><!-- /.entry-content -->
        <div class="comments">
      <h2>Comments !</h2>
      <div id="disqus_thread"></div>
      <script type="text/javascript">
        var disqus_identifier = "getting-started-with-autotools.html";
        (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://butidigressca.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
    </div>
    
  </article>
</section>
        <section id="extras" class="body">
                        <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                                                    <li><a href="http://docs.notmyidea.org/alexis/pelican/">Pelican</a></li>
                                                    <li><a href="http://python.org">Python.org</a></li>
                                                    <li><a href="http://life-unbalanced.tumblr.com/">Life, unbalanced</a></li>
                                                    <li><a href="http://excess.org">Ian Ward</a></li>
                                                    <li><a href="http://www.mahdiyusuf.com/">Mahdi Yusuf</a></li>
                                                    <li><a href="http://mikegrouchy.com/">Mike Grouchy</a></li>
                                                </ul>
                </div><!-- /.blogroll -->
                                <div class="social">
                        <h2>social</h2>
                        <ul>
                                                                                                                    <li><a href="http://feeds.feedburner.com/ButIDigress" type="application/rss+xml" rel="alternate">rss feed</a></li>
                                                            
                                                    <li><a href="http://twitter.com/msoulier">Twitter</a></li>
                                                </ul>
                </div><!-- /.social -->
                </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                <p>Email me at msoulier at digitaltorque dot ca</p>
                </address><!-- /#about -->

        </footer><!-- /#contentinfo -->

<script type="text/javascript">
    var disqus_shortname = 'butidigressca';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>